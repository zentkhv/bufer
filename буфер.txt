import logging
import logging.handlers
import os
import BaseHTTPServer

class MyHandler(BaseHTTPServer.BaseHTTPRequestHandler):
    
    def do_GET(self):
        if self.path == "/":
            # Открываем файл и читаем его содержимое
            with open("output.txt", "r") as f:
                data = f.read()
            # Отправляем заголовки HTTP
            self.send_response(200)
            self.send_header('Content-type', 'text/plain')
            self.end_headers()
            # Отправляем содержимое файла в ответ на запрос
            self.wfile.write(data)
        else:
            # Если запрос отправлен к другому URL, отвечаем 404 ошибкой
            self.send_error(404)

if __name__ == '__main__':
    # Настраиваем логирование
    log_file = "server.log"
    logger = logging.getLogger("server")
    logger.setLevel(logging.DEBUG)
    formatter = logging.Formatter('%(asctime)s - %(levelname)s - %(message)s')
    handler = logging.handlers.RotatingFileHandler(log_file, maxBytes=10*1024*1024, backupCount=5)
    handler.setFormatter(formatter)
    logger.addHandler(handler)
    # Запускаем сервер
    server_address = ('', 8000)
    httpd = BaseHTTPServer.HTTPServer(server_address, MyHandler)
    logger.info('Starting server on port 8000...')
    httpd.serve_forever()
